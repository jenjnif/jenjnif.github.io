<!DOCTYPE html>
<head>
   <link rel="stylesheet" href="/styles.css">
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Creating a website contact page part 1 - HTTP requests</title>

</head>
<body>
    <header>
      <h1>Jen Jones</h1>
          <nav class="navigation">
          <ul>
            <li><a id="home-link" href="/">Home</a></li>
            <li><a href="https://github.com/jenjnif">My GitHub</a></li>
            <li><a id="blog-link" href="/blog.html">Blog</a></li>
          </ul>
      </nav>
    </header>
  
  <div id="post">
<div class="blog-header">
<h2>Creating a website contact page part 1 - HTTP requests</h2>
</div>
<h2 class="blog-title"></h2>

<p><strong>I have built a content form, which is great, except that when it is filled in and the submit button is pressed the information entered doesn’t actually go anywhere and the user is just left with an http error message.</strong></p>

<p>To fix this I thought I could send the input to a server and then figure out how to use python to send it in an email to me. This proved harder than I initially thought.
<!--more-->
<br /></p>
<p align="center"><img src="/images/4-http/contactpage-and-error.png" alt="content form screenshot" width="90%" /></p>
<p><br /></p>
<h3 id="breaking-it-down">Breaking it down</h3>

<p>So I broke the problem down into steps. Firstly, what does it mean to send a request to the server? Well it involves HTTP requests; so, how do http requests work?</p>

<p>If we look at the error message in more detail:</p>

<p align="center"><img src="/images/4-http/http-error.png" alt="content form screenshot" width="60%" /></p>

<blockquote>
  <p><strong>“</strong>The request could not be satisfied.</p>
</blockquote>

<blockquote>
  <p>This distribution is not configured to allow the HTTP request method that was used for this request. The distribution supports only cachable requests.<strong>“</strong></p>
</blockquote>

<p><br />
This bascialy means that I have not configured the distribution () to POST requests (the request method used when clicking on the ‘submit’ button). The distribution will only support cachable requests i.e. GET requests. So in order to make my contact form work I need to configure POST requests.</p>

<p>In order to understand these request it is important to understand how http works. The next few steps take you though what I did and will give an idea of how GET and PUSH requests work.</p>

<p>installing it locally doesn’t affect any other python programmes that you might want to run as a global install would do</p>

<p><br /></p>
<h3 id="creating-a-virtual-environment-and-installing-flask">Creating a virtual environment and installing Flask</h3>

<p>The first thing I did was to create a virtual environment on my computer to keep all the dependences together and then install Flask here so it can all work together but is isolated. Like a little bubble of programmes and files separated away from the rest of your computer.</p>

<p>Steps on the command line:</p>

<p align="center"><img src="/images/4-http/createdir.png" alt="command line creating virtual environment" width="80%" /></p>

<p>Navigate to where you want to create the directory:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>me$ cd /Documents
</code></pre></div></div>

<p>Create a virtual environment (a directory) and give it a name e.g.’test-server’:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>me$ python3 -m venv test-server
</code></pre></div></div>

<p align="center"><img src="/images/4-http/createdir-explained.png" alt="creating virtual environment explained" width="70%" /></p>

<p>This runs the module ‘venv’ (virtual environment) with the parameter test-server, which creates a directory called ‘test-server’.</p>

<p>Then to activate the virtual environment in the command line we simply write:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>me$ source test-server/bin/activate
</code></pre></div></div>

<p>This changes the prompt to: (virtualenvironment-name) $</p>

<p>In my case from this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>me$
</code></pre></div></div>

<p>to this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(test-server) me$
</code></pre></div></div>

<p align="center"><img src="/images/4-http/prompt-name.png" alt="prompt name change" width="70%" /></p>

<p>Then we can install Flask and all it’s dependencies within the virtual environment:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(test-server) $ pip install flask
</code></pre></div></div>

<p><br /></p>
<h3 id="using-flask">Using Flask</h3>

<p align="center"><img src="/images/4-http/flaskdownload.png" alt="command to download flask" width="80%" /></p>

<p>Then follow the steps which can be found on the <a href="http://flask.pocoo.org/">Flask site</a>:</p>

<p>Create a python file - I called mine test-python.py - containing the following:</p>

<p align="center"><img src="/images/4-http/python-file.png" alt="Python code closeup" width="60%" /></p>

<p>Then create a file containing shell script (I called mine test-shellscsript.sh) containing the file name for your python file:</p>

<p align="center"><img src="/images/4-http/shell-script.png" alt="shell script closeup" width="60%" /></p>

<p><br /></p>
<h3 id="opening-a-port-to-listen-for-an-http-request">Opening a port to listen for an http request</h3>

<p>Then make sure you are in the test-server directory and run the shell script file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(test-server) me$ cd test-server
(test-server) me$ test-shellscript.sh This came back with an error: -bash: test-shellscript.sh: command not found So I checked the permissions of the files within the test-server directory to check the shell file is executable:

(test-server) me$ ls -al
</code></pre></div></div>

<p>Output:
-rw-r–r–@  1 jenjones  staff   52 21 Mar 21:37 test-shellscript.sh</p>

<p>Which is isn’t! No x. So I ran this code to change the access permissions so the shell file was executable:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(test-server) me$ chmod +x test-shellscript.sh
</code></pre></div></div>

<p>Then I ran the file again:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(test-server) me$ test-shellscript.sh
</code></pre></div></div>

<p>Again!:</p>

<p>-bash: test-shellscript.sh: command not found</p>

<p>WTF! So this is because I need to tell it that the to run the file from the directory I am currently in, otherwise it won’t find it. This can be shown by:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>me$ echo $PATH
</code></pre></div></div>

<p>Which gives back the path that terminal will look in to run the script file within our directory, test-server.</p>

<p>/Library/Frameworks/Python.framework/Versions/3.6/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin</p>

<p>As you can see the virtual server directory (test-server) is not checked so we need to tell it to run the file from the directory we are in. To do this add ./ before the command:</p>

 	(test-server) me$ ./test-shellscript.sh 

<p>Then the shell script executes our python file and we have an http port open, listening for anything. We bound our application to a port which is listening for an http request.</p>

<p><br /></p>
<h3 id="making-an-http-request-using-curl">Making an http request using curl</h3>

<p>Then we open another terminal window and make an http request using curl to that port.:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>me$ curl 127.0.0.1:5000 --verbose
</code></pre></div></div>

<p>This will send an http request over the port, the python script will run and send back “Hello World”
This can be seen more easily in a browser using the IP address and port.</p>

<p>https://www.digitalocean.com/community/tutorials/how-to-install-python-3-and-set-up-a-local-programming-environment-on-ubuntu-16-04</p>

</div>

  
  <div class="footer">
    <div class="contact">
      <p>
        Jen Jones<br />
      </p>
    </div>
    <div class="contact">
      <p>
        <a href="https://github.com/jenjnif">github.com/jenjnif</a><br />
      </p>
    </div>
  </div>
</div>


</body>
</html>